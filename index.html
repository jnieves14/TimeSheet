<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>TimeSheet</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

     <!-- Firebase References -->
     <script src="https://www.gstatic.com/firebasejs/6.3.3/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/6.3.3/firebase-database.js"></script>
  </head>

  <body>
    
    
    <!-- JUMBOTRON -->
    <div class="jumbotron">
      <h1 class="display-4"><center>Employee Data Management</center></h1>
      <br><center>A Comprehensive Directory of Employee Billable Hours</center>
    </div>



    
    <div class="container">

      <!-- TABLE -->
    <div class="table">
        <div class="panel panel-default">
            <div class="panel-heading">
              <h3 class="panel-title"> <span class="" aria-hidden="true"></span>Current Employees</h3>
            </div>
            <div class="parameterBody">
              <table class="table table-condensed">
              <tr>
                <th>Name</th>
                <th>Role</th>
                <th>Start Date</th>
                <th>Months Worked</th>
                <th>Monthly Rate ($)</th>
                <th>Total Billed ($)</th>
              </tr>
              <!-- <tr>
                  <div id="name-input">1</div>
                  <div id="role-input">1</div>
                  <div id="start-date-input">1</div>
                  <div id="moths-worked-input">1</div>
                  <div id="monthly-rate-input">1</div>
                  <div id="total-billed-input">1</div>
              </tr> -->
       
              </table>
            </div>
        </div>
        <br>



      <!-- FORM -->
        <div class="panel panel-default">
            <div class="panel-heading">
              <h3 class="panel-title"> <span class="" aria-hidden="true"></span>Add Employee</h3>
            </div>
            <div class="parameterBody">
                <form>
                    
                    <div class="name"><br>
                        <label for="name">Emplyee Name</label>
                        <input type="text" class="form-control" id="searchTerm">
                    </div>
                  
                    <br>
                    
                    <div class="Role">
                        <label for="role">Role</label>
                        <input type="text" class="form-control" id="number">
                    </div>

                    <br>
                    
                    <div class="start-date">
                      <label for="start-date">Start Date</label>
                      <input type="text" class="form-control" id="startY">
                    </div>

                    <br>
                    
                    <div class="months-worked">
                      <label for="months-worked">Months Worked</label>
                      <input type="text" class="form-control" id="endY">
                    </div><br>

                    <div class="monthly-rate">
                            <label for="monthly-rate">Monthly Rate</label>
                            <input type="text" class="form-control" id="endY">
                    </div><br>

                    <div class="total-billed">
                            <label for="total-billed">Total Billed</label>
                            <input type="text" class="form-control" id="endY">
                    </div>

                    <br>
                    <button type="button" class="btn btn-default btn-sm">
                      <span class="" aria-hidden="true"></span> Submit
                    </button>

                </form>
            </div>
        </div>
    </div>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script type="text/javascript" src="app.js"></script>
  </body>
</html>


<!-- jQuery -->
<script src="https://code.jquery.com/jquery.js"></script>

<!-- Script -->
<script>
  // ========================================== START CODING BELOW!!

  // Initialize Firebase
  var firebaseConfig = {
    apiKey: "AIzaSyBbS7nbr2EflrJSxR3oA1FmuS6_5Hpo7Xs",
    authDomain: "fir-intro-949fb.firebaseapp.com",
    databaseURL: "https://fir-intro-949fb.firebaseio.com",
    projectId: "fir-intro-949fb",
    storageBucket: "",
    messagingSenderId: "493944247",
    appId: "1:493944247:web:4670b58e3e5cd258"
  };

  firebase.initializeApp(firebaseconfig);

  // Create a variable to reference the database.
  var database = firebase.database();

  // Initial Values
  var name = "";
  var email = "";
  var age = 0;
  var comment = "";

  // Capture Button Click
  $("#add-user").on("click", function(event) {
    event.preventDefault();

    // Grabbed values from text boxes
    name = $("#name-input").val().trim();
    email = $("#email-input").val().trim();
    age = $("#age-input").val().trim();
    comment = $("#comment-input").val().trim();

    // Code for handling the push - puts a new property key, the unique identifier as a property key and the value is the entire object that gets passed
    database.ref().push({
      name: name,
      email: email,
      age: age,
      comment: comment,
      dateAdded: firebase.database.ServerValue.TIMESTAMP
    });

  });

  // Firebase watcher .on("child_added" -- since root value is always changong -- child added, repsonding to a different event name, snapshot -- we're only
  //concerned about the data we just put in the database, not the entire database itself
  //ex: adding users to petition list or subscription list // ex: you are now a user in our system
  database.ref().on("child_added", function(snapshot) {
    // storing the snapshot.val() in a variable for convenience
    var sv = snapshot.val();

    // Console.loging the last user's data
    console.log(sv.name);
    console.log(sv.email);
    console.log(sv.age);
    console.log(sv.comment);

    // Change the HTML to reflect
    $("#name-display").text(sv.name);
    $("#email-display").text(sv.email);
    $("#age-display").text(sv.age);
    $("#comment-display").text(sv.comment);

    // Handle the errors
  }, function(errorObject) {
    console.log("Errors handled: " + errorObject.code);
  });

  dataRef.ref().orderByChild("dateAdded").limitToLast(1).on("child_added", function(snapshot) {
      // Change the HTML to reflect
      $("#name-display").text(snapshot.val().name);
      $("#email-display").text(snapshot.val().email);
      $("#age-display").text(snapshot.val().age);
      $("#comment-display").text(snapshot.val().comment);
    });
    
</script>